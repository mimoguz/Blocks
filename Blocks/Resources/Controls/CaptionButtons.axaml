<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:blk="clr-namespace:Blocks.Controls">

    <Design.PreviewWith>
        <Border Padding="20">
            <StackPanel Spacing="20">
                <ThemeVariantScope RequestedThemeVariant="Dark">
                    <Border Background="Black">
                        <CaptionButtons Height="30" />
                    </Border>
                </ThemeVariantScope>
                <ThemeVariantScope RequestedThemeVariant="Light">
                    <CaptionButtons Height="30" />
                </ThemeVariantScope>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <PathIcon Data="{DynamicResource BlockFullScreenCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                    <PathIcon Data="{DynamicResource BlockWindowedCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                    <PathIcon Data="{DynamicResource BlockMaximizeCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                    <PathIcon Data="{DynamicResource BlockRestoreCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                    <PathIcon Data="{DynamicResource BlockMinimizeCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                    <PathIcon Data="{DynamicResource BlockCloseCaptionIcon}"
                              blk:Block.Stretch="Uniform" />
                </StackPanel>
            </StackPanel>
        </Border>
    </Design.PreviewWith>


    <!-- ****************************************************** -->
    <!-- ********************* Resources ********************** -->
    <!-- ****************************************************** -->

    <SolidColorBrush x:Key="BlockCaptionButtonForegroundBrush"
                     Color="{DynamicResource BlockWindowForegroundColor}" />

    <SolidColorBrush x:Key="BlockCaptionButtonBackgroundBrush"
                     Color="Transparent" />

    <SolidColorBrush x:Key="BlockCaptionButtonHighlightBrush"
                     Color="{DynamicResource BlockBaseButtonBackgroundColor}"
                     Opacity="{DynamicResource BlockFlatButtonHighlightOpacity}" />

    <SolidColorBrush x:Key="BlockCaptionButtonShadeBrush"
                     Color="{DynamicResource BlockBaseButtonBackgroundColor}"
                     Opacity="{DynamicResource BlockFlatButtonShadeOpacity}" />

    <SolidColorBrush x:Key="BlockCloseCaptionButtonHighlightBrush"
                     Color="{DynamicResource BlockRed}" />

    <SolidColorBrush x:Key="BlockCloseCaptionButtonShadeBrush"
                     Color="{DynamicResource BlockRed}"
                     Opacity="{DynamicResource BlockFlatButtonShadeOpacity}" />

    <StreamGeometry x:Key="BlockFullScreenCaptionIcon">
        M2048 2048v-819h-205v469l-1493 -1493h469v-205h-819v819h205v-469l1493 1493h-469v205h819z
    </StreamGeometry>

    <StreamGeometry x:Key="BlockWindowedCaptionIcon">
        M205 1024h819v-819h-205v469l-674 -674l-145 145l674 674h-469v205zM1374 1229h469v-205h-819v819h205v-469l674 674l145 -145z
    </StreamGeometry>

    <StreamGeometry x:Key="BlockMaximizeCaptionIcon">
        M2048 2048v-2048h-2048v2048h2048zM1843 1843h-1638v-1638h1638v1638z
    </StreamGeometry>

    <StreamGeometry x:Key="BlockRestoreCaptionIcon">
        M2048 410h-410v-410h-1638v1638h410v410h1638v-1638zM1434 1434h-1229v-1229h1229v1229zM1843 1843h-1229v-205h1024v-1024h205v1229z
    </StreamGeometry>

    <StreamGeometry x:Key="BlockMinimizeCaptionIcon">
        M2048 1229v-205h-2048v205h2048z
    </StreamGeometry>

    <StreamGeometry x:Key="BlockCloseCaptionIcon">
        M1169 1024l879 -879l-145 -145l-879 879l-879 -879l-145 145l879 879l-879 879l145 145l879 -879l879 879l145 -145z
    </StreamGeometry>

    <x:Double x:Key="BlockCaptionButtonWidth">45</x:Double>
    <x:Double x:Key="BlockCaptionButtonHeight">30</x:Double>

    <!-- ****************************************************** -->
    <!-- ********************** Themes ************************ -->
    <!-- ****************************************************** -->


    <ControlTheme x:Key="BlockCaptionButton" TargetType="Button">

        <Setter Property="Background" Value="{DynamicResource BlockCaptionButtonHighlightBrush}" />
        <!-- Reusing BorderBrush to define pressed background color, as it's not used otherwise -->
        <Setter Property="BorderBrush" Value="{DynamicResource BlockCaptionButtonShadeBrush}" />
        <Setter Property="Foreground" Value="{DynamicResource BlockCaptionButtonForegroundBrush}" />
        <Setter Property="Width" Value="{DynamicResource BlockCaptionButtonWidth}" />
        <Setter Property="Height" Value="{DynamicResource BlockCaptionButtonHeight}" />
        <Setter Property="VerticalAlignment" Value="Stretch" />

        <Setter Property="Template">
            <ControlTemplate>
                <ContentPresenter Name="PART_ContentPresenter"
                                  Background="Transparent"
                                  Content="{TemplateBinding Content}">
                    <ContentPresenter.Transitions>
                        <Transitions>
                            <BrushTransition Property="Background"
                                             Duration="{DynamicResource BlockButtonStateTransitionDuration}"
                                             Easing="CubicEaseOut" />
                        </Transitions>
                    </ContentPresenter.Transitions>
                </ContentPresenter>
            </ControlTemplate>
        </Setter>

        <Style Selector="^:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{TemplateBinding Background}" />
        </Style>

        <Style Selector="^:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{TemplateBinding BorderBrush}" />
        </Style>
    </ControlTheme>

    <ControlTheme x:Key="{x:Type CaptionButtons}" TargetType="CaptionButtons">
        <Setter Property="MaxHeight" Value="30" />
        <Setter Property="Template">
            <ControlTemplate>
                <StackPanel Spacing="2" VerticalAlignment="Stretch" TextElement.FontSize="10" Orientation="Horizontal">
                    <Button x:Name="PART_FullScreenButton"
                            Theme="{StaticResource BlockCaptionButton}"
                            IsVisible="False">
                        <Viewbox Width="11" Margin="2">
                            <Path Name="FullScreenButtonPath"
                                  Stretch="UniformToFill"
                                  Fill="{TemplateBinding Foreground}"
                                  Data="{StaticResource BlockFullScreenCaptionIcon}" />
                        </Viewbox>
                    </Button>
                    <Button x:Name="PART_MinimizeButton"
                            Theme="{StaticResource BlockCaptionButton}"
                            AutomationProperties.Name="Minimize"
                            Win32Properties.NonClientHitTestResult="MinButton">
                        <Viewbox Width="11" Margin="2">
                            <Path Stretch="UniformToFill"
                                  Fill="{TemplateBinding Foreground}"
                                  Data="{StaticResource BlockMinimizeCaptionIcon}" />
                        </Viewbox>
                    </Button>
                    <Button x:Name="PART_RestoreButton"
                            Theme="{StaticResource BlockCaptionButton}"
                            AutomationProperties.Name="Maximize"
                            Win32Properties.NonClientHitTestResult="MaxButton">
                        <Viewbox Width="11" Margin="2">
                            <Viewbox.RenderTransform>
                                <RotateTransform Angle="-90" />
                            </Viewbox.RenderTransform>
                            <Path Name="RestoreButtonPath"
                                  Stretch="UniformToFill"
                                  Fill="{TemplateBinding Foreground}"
                                  Data="{StaticResource BlockMaximizeCaptionIcon}" />
                        </Viewbox>
                    </Button>
                    <Button x:Name="PART_CloseButton"
                            Background="{DynamicResource BlockCloseCaptionButtonHighlightBrush}"
                            BorderBrush="{DynamicResource BlockCloseCaptionButtonShadeBrush}"
                            Theme="{StaticResource BlockCaptionButton}"
                            AutomationProperties.Name="Close"
                            Win32Properties.NonClientHitTestResult="Close">
                        <Viewbox Width="11" Margin="2">
                            <Path Stretch="UniformToFill"
                                  Fill="{TemplateBinding Foreground}"
                                  Data="{StaticResource BlockCloseCaptionIcon}" />
                        </Viewbox>
                    </Button>
                </StackPanel>
            </ControlTemplate>
        </Setter>
        <Style Selector="^:maximized /template/ Path#RestoreButtonPath">
            <Setter Property="Data" Value="{StaticResource BlockWindowedCaptionIcon}" />
        </Style>
        <Style Selector="^:fullscreen /template/ Path#FullScreenButtonPath">
            <Setter Property="IsVisible" Value="True" />
            <Setter Property="Data" Value="{StaticResource BlockRestoreCaptionIcon}" />
        </Style>
        <Style Selector="^:fullscreen /template/ Button#PART_RestoreButton">
            <Setter Property="IsVisible" Value="False" />
        </Style>
        <Style Selector="^:fullscreen /template/ Button#PART_MinimizeButton">
            <Setter Property="IsVisible" Value="False" />
        </Style>
        <Style Selector="^ /template/ Button#PART_RestoreButton:disabled">
            <Setter Property="Opacity" Value="{DynamicResource BlockDisabledOpacity}" />
        </Style>
    </ControlTheme>
</ResourceDictionary>