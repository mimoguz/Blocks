<!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see https://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
-->

<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="using:System"
                    xmlns:blk="clr-namespace:Blocks.Controls">
    <Design.PreviewWith>
        <Border Padding="20" Height="500">
            <StackPanel Spacing="20" VerticalAlignment="Center">
                <DatePicker />
                <DatePicker Classes="outlined" />
                <DatePicker Classes="opaque" />
                <DatePicker Classes="flat" />
                <DatePicker IsEnabled="False" />
                <DatePicker>
                    <DataValidationErrors.Error>
                        <sys:Exception>
                            <x:Arguments>
                                <x:String>Error</x:String>
                            </x:Arguments>
                        </sys:Exception>
                    </DataValidationErrors.Error>
                </DatePicker>
            </StackPanel>
        </Border>
    </Design.PreviewWith>

    <x:Double x:Key="BlockDatePickerThemeMinWidth">296</x:Double>
    <x:Double x:Key="BlockDatePickerThemeMaxWidth">456</x:Double>

    <ControlTheme x:Key="{x:Type DatePicker}" TargetType="DatePicker">
        <Setter Property="Background" Value="{DynamicResource BlockDtPickerBaseButtonBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{DynamicResource BlockOutlinedDtPickerBaseButtonBorderBrush}" />
        <Setter Property="BorderThickness" Value="{DynamicResource BlockControlBorderThickness}" />
        <Setter Property="Foreground" Value="{DynamicResource BlockDtPickerButtonForegroundBrush}" />
        <Setter Property="CornerRadius" Value="{DynamicResource BlockButtonCornerRadius}" />
        <Setter Property="Padding" Value="{DynamicResource BlockDtPickerButtonSectionPadding}" />
        <Setter Property="Template">
            <ControlTemplate>
                <DataValidationErrors>
                    <Panel Name="LayoutRoot">
                        <Button Name="PART_FlyoutButton"
                                Foreground="{TemplateBinding Foreground}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="0"
                                CornerRadius="{TemplateBinding CornerRadius}"
                                IsEnabled="{TemplateBinding IsEnabled}"
                                MinWidth="{DynamicResource BlockDatePickerThemeMinWidth}"
                                MaxWidth="{DynamicResource BlockDatePickerThemeMaxWidth}"
                                HorizontalContentAlignment="Stretch"
                                VerticalContentAlignment="Stretch"
                                TemplatedControl.IsTemplateFocusTarget="True">
                            <Grid Name="PART_ButtonContentGrid" ColumnDefinitions="3*,Auto,5*,Auto,3*">
                                <TextBlock Name="PART_DayTextBlock" Text="{DynamicResource StringDatePickerDayText}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="{Binding $parent[Button].Foreground}"
                                           Padding="{TemplateBinding Padding}" />
                                <TextBlock Name="PART_MonthTextBlock"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="{Binding $parent[Button].Foreground}"
                                           Text="{DynamicResource StringDatePickerMonthText}" TextAlignment="Left"
                                           Padding="{TemplateBinding Padding}" />
                                <TextBlock Name="PART_YearTextBlock" Text="{DynamicResource StringDatePickerYearText}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="{Binding $parent[Button].Foreground}"
                                           Padding="{TemplateBinding Padding}" />
                                <Rectangle x:Name="PART_FirstSpacer"
                                           Fill="{DynamicResource BlockFlatDtPickerButtonDividerBrush}"
                                           HorizontalAlignment="Center"
                                           Width="1" Margin="{DynamicResource BlockDtPickerButtonDividerMargin}"
                                           Grid.Column="1" />
                                <Rectangle x:Name="PART_SecondSpacer"
                                           Fill="{DynamicResource BlockFlatDtPickerButtonDividerBrush}"
                                           HorizontalAlignment="Center"
                                           Width="1" Margin="{DynamicResource BlockDtPickerButtonDividerMargin}"
                                           Grid.Column="3" />
                            </Grid>
                        </Button>

                        <Popup Name="PART_Popup" WindowManagerAddShadowHint="False"
                               IsLightDismissEnabled="True" PlacementTarget="{TemplateBinding}"
                               Placement="Bottom">
                            <DatePickerPresenter Name="PART_PickerPresenter" />
                        </Popup>

                    </Panel>
                </DataValidationErrors>
            </ControlTemplate>
        </Setter>

        <Style Selector="^.flat">
            <Setter Property="Background" Value="{DynamicResource BlockFlatDtPickerBaseButtonBackgroundBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource BlockFlatDtPickerButtonForegroundBrush}" />
            <Style Selector="^ /template/ Button#PART_FlyoutButton">
                <Setter Property="blk:Block.ButtonStyle" Value="Flat" />
            </Style>
            <Style Selector="^ /template/ Rectangle">
                <Setter Property="Fill" Value="{DynamicResource BlockFlatDtPickerButtonDividerBrush}" />
            </Style>
        </Style>

        <Style Selector="^.outlined">
            <Setter Property="Background" Value="{DynamicResource BlockOutlinedDtPickerBaseButtonBackgroundBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource BlockOutlinedDtPickerButtonForegroundBrush}" />
            <Style Selector="^ /template/ Button#PART_FlyoutButton">
                <Setter Property="blk:Block.ButtonStyle" Value="Outlined" />
            </Style>
            <Style Selector="^ /template/ Rectangle">
                <Setter Property="Fill" Value="{DynamicResource BlockOutlinedDtPickerButtonDividerBrush}" />
            </Style>
        </Style>

        <Style Selector="^.opaque">
            <Setter Property="Background" Value="{DynamicResource BlockOpaqueDtPickerButtonBackgroundBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource BlockOpaqueDtPickerButtonForegroundBrush}" />
            <Style Selector="^ /template/ Button#PART_FlyoutButton">
                <Setter Property="blk:Block.ButtonStyle" Value="Opaque" />
            </Style>
            <Style Selector="^ /template/ Rectangle">
                <Setter Property="Fill" Value="{DynamicResource BlockOpaqueDtPickerButtonForegroundBrush}" />
            </Style>
        </Style>

        <Style Selector="^:hasnodate /template/ Button#PART_FlyoutButton TextBlock">
            <Setter Property="Opacity" Value="{DynamicResource BlockPlaceholderOpacity}" />
        </Style>
    </ControlTheme>

    <!--WinUI: DatePickerFlyoutPresenter-->
    <ControlTheme x:Key="{x:Type DatePickerPresenter}" TargetType="DatePickerPresenter">

        <Setter Property="Width" Value="{DynamicResource BlockDtPickerFlyoutWidth}" />
        <Setter Property="MinWidth" Value="{DynamicResource BlockDtPickerFlyoutWidth}" />
        <Setter Property="MaxHeight" Value="{DynamicResource BlockDtPickerMaxFlyoutHeight}" />
        <Setter Property="Background" Value="{DynamicResource BlockDtPickerBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{DynamicResource BlockDtPickerBorderBrush}" />
        <Setter Property="BorderThickness" Value="{DynamicResource BlockFlyoutBorderThickness}" />
        <Setter Property="CornerRadius" Value="{DynamicResource BlockFlyoutCornerRadius}" />

        <Setter Property="Template">
            <ControlTemplate>
                <Panel MaxHeight="{TemplateBinding MaxHeight}">
                    <Border Name="Background"
                            Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            ClipToBounds="True">
                        <Grid Name="ContentRoot" RowDefinitions="*,Auto,Auto">
                            <Grid Name="PART_PickerContainer">
                                <Grid.Styles>
                                    <Style Selector="DateTimePickerPanel > ListBoxItem">
                                        <Setter Property="Theme" Value="{StaticResource BlockDateTimePickerItem}" />
                                    </Style>
                                </Grid.Styles>
                                <Grid.Resources>
                                    <x:Double x:Key="BlockMenuItemSpacing">0</x:Double>
                                </Grid.Resources>

                                <!--Column Definitions set in code, ignore here-->

                                <Rectangle Name="HighlightRect"
                                           Fill="{DynamicResource BlockDtPickerSelectedItemBackgroundBrush}"
                                           Grid.Column="0" Grid.ColumnSpan="5"
                                           VerticalAlignment="Center"
                                           Height="{DynamicResource BlockDtPickerItemHeight}" />

                                <Panel Name="PART_MonthHost">
                                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                                  VerticalScrollBarVisibility="Hidden"
                                                  OpacityMask="{DynamicResource BlockDtPickerOpacityMask}">
                                        <DateTimePickerPanel Name="PART_MonthSelector"
                                                             PanelType="Month"
                                                             ItemHeight="{DynamicResource BlockDtPickerItemHeight}"
                                                             ShouldLoop="True" />
                                    </ScrollViewer>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Top">
                                        <RepeatButton Name="PART_MonthUpButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerUpIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Bottom">
                                        <RepeatButton Name="PART_MonthDownButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerDownIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                </Panel>
                                <Panel Name="PART_DayHost">
                                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                                  VerticalScrollBarVisibility="Hidden"
                                                  OpacityMask="{DynamicResource BlockDtPickerOpacityMask}">
                                        <DateTimePickerPanel Name="PART_DaySelector"
                                                             PanelType="Day"
                                                             ItemHeight="{DynamicResource BlockDtPickerItemHeight}"
                                                             ShouldLoop="True" />
                                    </ScrollViewer>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Top">
                                        <RepeatButton Name="PART_DayUpButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerUpIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Bottom">
                                        <RepeatButton Name="PART_DayDownButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerDownIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                </Panel>
                                <Panel Name="PART_YearHost">
                                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                                  VerticalScrollBarVisibility="Hidden"
                                                  OpacityMask="{DynamicResource BlockDtPickerOpacityMask}">
                                        <DateTimePickerPanel Name="PART_YearSelector"
                                                             PanelType="Year"
                                                             ItemHeight="{DynamicResource BlockDtPickerItemHeight}"
                                                             ShouldLoop="False" />
                                    </ScrollViewer>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Top">
                                        <RepeatButton Name="PART_YearUpButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerUpIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                    <Border Background="{DynamicResource BlockDtPickerBackgroundOverlayBrush}"
                                            VerticalAlignment="Bottom">
                                        <RepeatButton Name="PART_YearDownButton"
                                                      Theme="{StaticResource BlockDtPickerRepeatButton}"
                                                      IsVisible="True">
                                            <PathIcon Theme="{DynamicResource BlockDtPickerDownIcon}"
                                                      Classes="block-icon" />
                                        </RepeatButton>
                                    </Border>
                                </Panel>

                                <Rectangle Name="PART_FirstSpacer"
                                           Fill="{DynamicResource BlockDtPickerSeparatorBrush}"
                                           HorizontalAlignment="Center"
                                           Width="1"
                                           Grid.Column="1" />
                                <Rectangle Name="PART_SecondSpacer"
                                           Fill="{DynamicResource BlockDtPickerSeparatorBrush}"
                                           HorizontalAlignment="Center"
                                           Width="1"
                                           Grid.Column="3" />
                            </Grid>
                            <Rectangle Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3"
                                       Height="1"
                                       Fill="{DynamicResource BlockDtPickerSeparatorBrush}" />

                            <Grid Name="AcceptDismissGrid"
                                  Grid.Row="2"
                                  ColumnDefinitions="*,*"
                                  ColumnSpacing="2"
                                  Margin="{DynamicResource BlockFlyoutPadding}">

                                <Button Name="PART_AcceptButton"
                                        Grid.Column="0"
                                        HorizontalAlignment="Stretch"
                                        Classes="flat"
                                        VerticalAlignment="Stretch">
                                    <PathIcon Foreground="{Binding $parent[Button].Foreground}"
                                              Data="{DynamicResource BlockCheckMark}"
                                              Classes="block-icon" />
                                </Button>
                                <Button Name="PART_DismissButton"
                                        Grid.Column="1"
                                        Classes="flat"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch">
                                    <PathIcon Foreground="{Binding $parent[Button].Foreground}"
                                              Data="{DynamicResource BlockCrossIcon}"
                                              Classes="block-icon" />
                                </Button>
                            </Grid>
                        </Grid>
                    </Border>
                    <Border CornerRadius="{TemplateBinding CornerRadius}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}" />
                </Panel>
            </ControlTemplate>
        </Setter>
    </ControlTheme>
</ResourceDictionary>